"use strict";(self.webpackChunkoneboy_app=self.webpackChunkoneboy_app||[]).push([[2927],{1911:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var s=t(9729);const l={},d=s.createContext(l);function r(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(d.Provider,{value:n},e.children)}},7089:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>x,frontMatter:()=>r,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"Database/585.2016\u5e74\u7684\u6295\u8d44","title":"585.2016\u5e74\u7684\u6295\u8d44","description":"|\u5e8f\u53f7|\u9898\u76ee|\u96be\u5ea6|","source":"@site/leetcode/Database/585.2016\u5e74\u7684\u6295\u8d44.md","sourceDirName":"Database","slug":"/585","permalink":"/leetcode/585","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1752478507000,"sidebarPosition":585,"frontMatter":{"sidebar_position":585,"slug":"/585"},"sidebar":"leetcodeSidebar","previous":{"title":"584.\u5bfb\u627e\u7528\u6237\u63a8\u8350\u4eba","permalink":"/leetcode/584"},"next":{"title":"586.\u8ba2\u5355\u6700\u591a\u7684\u5ba2\u6237","permalink":"/leetcode/586"}}');var l=t(5813),d=t(1911);const r={sidebar_position:585,slug:"/585"},i="585.2016\u5e74\u7684\u6295\u8d44",c={},h=[{value:"\u9898\u76ee\u5927\u610f",id:"\u9898\u76ee\u5927\u610f",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:3},{value:"\u8f93\u5165",id:"\u8f93\u5165",level:4},{value:"\u8f93\u51fa",id:"\u8f93\u51fa",level:4},{value:"\u89e3\u91ca",id:"\u89e3\u91ca",level:4},{value:"\u53c2\u8003\u7b54\u6848",id:"\u53c2\u8003\u7b54\u6848",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"5852016\u5e74\u7684\u6295\u8d44",children:"585.2016\u5e74\u7684\u6295\u8d44"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u5e8f\u53f7"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u9898\u76ee"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u96be\u5ea6"})]})}),(0,l.jsx)(n.tbody,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"585"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:(0,l.jsx)(n.a,{href:"https://leetcode.cn/problems/investments-in-2016/",children:"\u9898\u76ee\u94fe\u63a5"})}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e2d\u7b49"})]})})]}),"\n",(0,l.jsx)(n.h2,{id:"\u9898\u76ee\u5927\u610f",children:"\u9898\u76ee\u5927\u610f"}),"\n",(0,l.jsx)(n.p,{children:"\u7f16\u5199\u89e3\u51b3\u65b9\u6848\u62a5\u544a 2016 \u5e74 (tiv_2016) \u6240\u6709\u6ee1\u8db3\u4e0b\u8ff0\u6761\u4ef6\u7684\u6295\u4fdd\u4eba\u7684\u6295\u4fdd\u91d1\u989d\u4e4b\u548c\uff1a"}),"\n",(0,l.jsxs)(n.p,{children:["\u4ed6\u5728 2015 \u5e74\u7684\u6295\u4fdd\u989d (tiv_2015) \u81f3\u5c11\u8ddf\u4e00\u4e2a\u5176\u4ed6\u6295\u4fdd\u4eba\u5728 2015 \u5e74\u7684\u6295\u4fdd\u989d\u76f8\u540c\u3002\n\u4ed6\u6240\u5728\u7684\u57ce\u5e02\u5fc5\u987b\u4e0e\u5176\u4ed6\u6295\u4fdd\u4eba\u90fd\u4e0d\u540c\uff08\u4e5f\u5c31\u662f\u8bf4 (lat, lon) \u4e0d\u80fd\u8ddf\u5176\u4ed6\u4efb\u4f55\u4e00\u4e2a\u6295\u4fdd\u4eba\u5b8c\u5168\u76f8\u540c\uff09\u3002\ntiv_2016 ",(0,l.jsx)(n.strong,{children:"\u56db\u820d\u4e94\u5165\u7684"})," \u4e24\u4f4d\u5c0f\u6570 \u3002"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Insurance"})," \u8868"]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Column Name"}),(0,l.jsx)(n.th,{children:"Type"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"pid"}),(0,l.jsx)(n.td,{children:"int"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"tiv_2015"}),(0,l.jsx)(n.td,{children:"float"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"tiv_2016"}),(0,l.jsx)(n.td,{children:"float"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"lat"}),(0,l.jsx)(n.td,{children:"float"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"lon"}),(0,l.jsx)(n.td,{children:"float"})]})]})]}),"\n",(0,l.jsx)(n.p,{children:"pid \u662f\u8fd9\u5f20\u8868\u7684\u4e3b\u952e(\u5177\u6709\u552f\u4e00\u503c\u7684\u5217)\u3002\n\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u90fd\u5305\u542b\u4e00\u6761\u4fdd\u9669\u4fe1\u606f\uff0c\u5176\u4e2d\uff1a\npid \u662f\u6295\u4fdd\u4eba\u7684\u6295\u4fdd\u7f16\u53f7\u3002\ntiv_2015 \u662f\u8be5\u6295\u4fdd\u4eba\u5728 2015 \u5e74\u7684\u603b\u6295\u4fdd\u91d1\u989d\uff0ctiv_2016 \u662f\u8be5\u6295\u4fdd\u4eba\u5728 2016 \u5e74\u7684\u603b\u6295\u4fdd\u91d1\u989d\u3002\nlat \u662f\u6295\u4fdd\u4eba\u6240\u5728\u57ce\u5e02\u7684\u7eac\u5ea6\u3002\u9898\u76ee\u6570\u636e\u786e\u4fdd lat \u4e0d\u4e3a\u7a7a\u3002\nlon \u662f\u6295\u4fdd\u4eba\u6240\u5728\u57ce\u5e02\u7684\u7ecf\u5ea6\u3002\u9898\u76ee\u6570\u636e\u786e\u4fdd lon \u4e0d\u4e3a\u7a7a\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,l.jsx)(n.h4,{id:"\u8f93\u5165",children:"\u8f93\u5165"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Insurance"})," \u8868\uff1a"]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"pid"}),(0,l.jsx)(n.th,{children:"tiv_2015"}),(0,l.jsx)(n.th,{children:"tiv_2016"}),(0,l.jsx)(n.th,{children:"lat"}),(0,l.jsx)(n.th,{children:"lon"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"1"}),(0,l.jsx)(n.td,{children:"10"}),(0,l.jsx)(n.td,{children:"5"}),(0,l.jsx)(n.td,{children:"10"}),(0,l.jsx)(n.td,{children:"10"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"2"}),(0,l.jsx)(n.td,{children:"20"}),(0,l.jsx)(n.td,{children:"20"}),(0,l.jsx)(n.td,{children:"20"}),(0,l.jsx)(n.td,{children:"20"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"3"}),(0,l.jsx)(n.td,{children:"10"}),(0,l.jsx)(n.td,{children:"30"}),(0,l.jsx)(n.td,{children:"20"}),(0,l.jsx)(n.td,{children:"20"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"4"}),(0,l.jsx)(n.td,{children:"10"}),(0,l.jsx)(n.td,{children:"40"}),(0,l.jsx)(n.td,{children:"40"}),(0,l.jsx)(n.td,{children:"40"})]})]})]}),"\n",(0,l.jsx)(n.h4,{id:"\u8f93\u51fa",children:"\u8f93\u51fa"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.th,{children:"tiv_2016"})})}),(0,l.jsx)(n.tbody,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"45.00"})})})]}),"\n",(0,l.jsx)(n.h4,{id:"\u89e3\u91ca",children:"\u89e3\u91ca"}),"\n",(0,l.jsx)(n.p,{children:"\u8868\u4e2d\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55\u548c\u6700\u540e\u4e00\u6761\u8bb0\u5f55\u90fd\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6\u3002\ntiv_2015 \u503c\u4e3a 10 \u4e0e\u7b2c\u4e09\u6761\u548c\u7b2c\u56db\u6761\u8bb0\u5f55\u76f8\u540c\uff0c\u4e14\u5176\u4f4d\u7f6e\u662f\u552f\u4e00\u7684\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u7b2c\u4e8c\u6761\u8bb0\u5f55\u4e0d\u7b26\u5408\u4efb\u4f55\u4e00\u4e2a\u6761\u4ef6\u3002\u5176 tiv_2015 \u4e0e\u5176\u4ed6\u6295\u4fdd\u4eba\u4e0d\u540c\uff0c\u5e76\u4e14\u4f4d\u7f6e\u4e0e\u7b2c\u4e09\u6761\u8bb0\u5f55\u76f8\u540c\uff0c\u8fd9\u4e5f\u5bfc\u81f4\u4e86\u7b2c\u4e09\u6761\u8bb0\u5f55\u4e0d\u7b26\u5408\u9898\u76ee\u8981\u6c42\u3002\n\u56e0\u6b64\uff0c\u7ed3\u679c\u662f\u7b2c\u4e00\u6761\u8bb0\u5f55\u548c\u6700\u540e\u4e00\u6761\u8bb0\u5f55\u7684 tiv_2016 \u4e4b\u548c\uff0c\u5373 45 \u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u53c2\u8003\u7b54\u6848",children:"\u53c2\u8003\u7b54\u6848"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-SQL",children:"with a1 as (\nselect\ntiv_2015\n,count(1) as cnt\nfrom Insurance\ngroup by 1\nhaving cnt > 1\n),\na2 as (\nselect\n lat\n,lon\n,count(1) as cnt\nfrom Insurance\ngroup by 1,2\nhaving cnt > 1\n)\nselect\nround(sum(t1.tiv_2016),2) as tiv_2016\nfrom Insurance t1\nleft join a2\non t1.lat = a2.lat\nand t1.lon = a2.lon\nwhere t1.tiv_2015 in (select tiv_2015 from a1)\nand a2.lat is null\n;\n"})})]})}function x(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);