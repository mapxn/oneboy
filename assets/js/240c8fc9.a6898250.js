"use strict";(self.webpackChunkoneboy_app=self.webpackChunkoneboy_app||[]).push([[1540],{1911:(e,d,n)=>{n.d(d,{R:()=>l,x:()=>i});var s=n(9729);const t={},r=s.createContext(t);function l(e){const d=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(d):{...d,...e}}),[d,e])}function i(e){let d;return d=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:d},e.children)}},8765:(e,d,n)=>{n.r(d),n.d(d,{assets:()=>c,contentTitle:()=>i,default:()=>j,frontMatter:()=>l,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"Database/\u884c\u7a0b\u548c\u7528\u6237","title":"262.\u884c\u7a0b\u548c\u7528\u6237","description":"|\u5e8f\u53f7|\u9898\u76ee|\u96be\u5ea6|","source":"@site/leetcode/Database/262.\u884c\u7a0b\u548c\u7528\u6237.md","sourceDirName":"Database","slug":"/262","permalink":"/leetcode/262","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1752478507000,"sidebarPosition":262,"frontMatter":{"sidebar_position":262,"slug":"/262"},"sidebar":"leetcodeSidebar","previous":{"title":"197.\u4e0a\u5347\u7684\u6e29\u5ea6","permalink":"/leetcode/197"},"next":{"title":"511.\u6e38\u620f\u73a9\u6cd5\u5206\u6790 I","permalink":"/leetcode/511"}}');var t=n(5813),r=n(1911);const l={sidebar_position:262,slug:"/262"},i="262.\u884c\u7a0b\u548c\u7528\u6237",c={},h=[{value:"\u9898\u76ee\u5927\u610f",id:"\u9898\u76ee\u5927\u610f",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:3},{value:"\u8f93\u5165",id:"\u8f93\u5165",level:4},{value:"\u8f93\u51fa",id:"\u8f93\u51fa",level:4},{value:"\u89e3\u91ca",id:"\u89e3\u91ca",level:4},{value:"\u53c2\u8003\u7b54\u6848",id:"\u53c2\u8003\u7b54\u6848",level:2}];function x(e){const d={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.header,{children:(0,t.jsx)(d.h1,{id:"262\u884c\u7a0b\u548c\u7528\u6237",children:"262.\u884c\u7a0b\u548c\u7528\u6237"})}),"\n",(0,t.jsxs)(d.table,{children:[(0,t.jsx)(d.thead,{children:(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.th,{style:{textAlign:"left"},children:"\u5e8f\u53f7"}),(0,t.jsx)(d.th,{style:{textAlign:"left"},children:"\u9898\u76ee"}),(0,t.jsx)(d.th,{style:{textAlign:"left"},children:"\u96be\u5ea6"})]})}),(0,t.jsx)(d.tbody,{children:(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{style:{textAlign:"left"},children:"262"}),(0,t.jsx)(d.td,{style:{textAlign:"left"},children:(0,t.jsx)(d.a,{href:"https://leetcode.com/problems/trips-and-users/",children:"\u9898\u76ee\u94fe\u63a5"})}),(0,t.jsx)(d.td,{style:{textAlign:"left"},children:"\u56f0\u96be"})]})})]}),"\n",(0,t.jsx)(d.h2,{id:"\u9898\u76ee\u5927\u610f",children:"\u9898\u76ee\u5927\u610f"}),"\n",(0,t.jsx)(d.p,{children:'\u7f16\u5199\u89e3\u51b3\u65b9\u6848\u627e\u51fa "2013-10-01" \u81f3 "2013-10-03" \u671f\u95f4\u6709 \u81f3\u5c11 \u4e00\u6b21\u884c\u7a0b\u7684\u975e\u7981\u6b62\u7528\u6237\uff08\u4e58\u5ba2\u548c\u53f8\u673a\u90fd\u5fc5\u987b\u672a\u88ab\u7981\u6b62\uff09\u7684 \u53d6\u6d88\u7387\u3002\u975e\u7981\u6b62\u7528\u6237\u5373 banned \u4e3a No \u7684\u7528\u6237\uff0c\u7981\u6b62\u7528\u6237\u5373 banned \u4e3a Yes \u7684\u7528\u6237\u3002\u5176\u4e2d\u53d6\u6d88\u7387 Cancellation Rate \u9700\u8981\u56db\u820d\u4e94\u5165\u4fdd\u7559 \u4e24\u4f4d\u5c0f\u6570 \u3002'}),"\n",(0,t.jsx)(d.p,{children:"\u8fd4\u56de\u7ed3\u679c\u8868\u4e2d\u7684\u6570\u636e \u65e0\u987a\u5e8f\u8981\u6c42 \u3002"}),"\n",(0,t.jsxs)(d.p,{children:["\u8868\uff1a",(0,t.jsx)(d.strong,{children:"Trips"})]}),"\n",(0,t.jsxs)(d.table,{children:[(0,t.jsx)(d.thead,{children:(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.th,{children:"Column Name"}),(0,t.jsx)(d.th,{children:"Type"})]})}),(0,t.jsxs)(d.tbody,{children:[(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"id"}),(0,t.jsx)(d.td,{children:"int"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"client_id"}),(0,t.jsx)(d.td,{children:"int"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"driver_id"}),(0,t.jsx)(d.td,{children:"int"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"city_id"}),(0,t.jsx)(d.td,{children:"int"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"status"}),(0,t.jsx)(d.td,{children:"enum"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"request_at"}),(0,t.jsx)(d.td,{children:"varchar"})]})]})]}),"\n",(0,t.jsx)(d.p,{children:"id \u662f\u8fd9\u5f20\u8868\u7684\u4e3b\u952e\uff08\u5177\u6709\u552f\u4e00\u503c\u7684\u5217\uff09\u3002\n\u8fd9\u5f20\u8868\u4e2d\u5b58\u6240\u6709\u51fa\u79df\u8f66\u7684\u884c\u7a0b\u4fe1\u606f\u3002\u6bcf\u6bb5\u884c\u7a0b\u6709\u552f\u4e00 id \uff0c\u5176\u4e2d client_id \u548c driver_id \u662f Users \u8868\u4e2d users_id \u7684\u5916\u952e\u3002\nstatus \u662f\u4e00\u4e2a\u8868\u793a\u884c\u7a0b\u72b6\u6001\u7684\u679a\u4e3e\u7c7b\u578b\uff0c\u679a\u4e3e\u6210\u5458\u4e3a(\u2018completed\u2019, \u2018cancelled_by_driver\u2019, \u2018cancelled_by_client\u2019) \u3002"}),"\n",(0,t.jsxs)(d.p,{children:["\u8868\uff1a",(0,t.jsx)(d.strong,{children:"Users"})]}),"\n",(0,t.jsxs)(d.table,{children:[(0,t.jsx)(d.thead,{children:(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.th,{children:"Column Name"}),(0,t.jsx)(d.th,{children:"Type"})]})}),(0,t.jsxs)(d.tbody,{children:[(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"users_id"}),(0,t.jsx)(d.td,{children:"int"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"banned"}),(0,t.jsx)(d.td,{children:"enum"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"role"}),(0,t.jsx)(d.td,{children:"enum"})]})]})]}),"\n",(0,t.jsx)(d.p,{children:"users_id \u662f\u8fd9\u5f20\u8868\u7684\u4e3b\u952e\uff08\u5177\u6709\u552f\u4e00\u503c\u7684\u5217\uff09\u3002\n\u8fd9\u5f20\u8868\u4e2d\u5b58\u6240\u6709\u7528\u6237\uff0c\u6bcf\u4e2a\u7528\u6237\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684 users_id \uff0crole \u662f\u4e00\u4e2a\u8868\u793a\u7528\u6237\u8eab\u4efd\u7684\u679a\u4e3e\u7c7b\u578b\uff0c\u679a\u4e3e\u6210\u5458\u4e3a (\u2018client\u2019, \u2018driver\u2019, \u2018partner\u2019) \u3002\nbanned \u662f\u4e00\u4e2a\u8868\u793a\u7528\u6237\u662f\u5426\u88ab\u7981\u6b62\u7684\u679a\u4e3e\u7c7b\u578b\uff0c\u679a\u4e3e\u6210\u5458\u4e3a (\u2018Yes\u2019, \u2018No\u2019) \u3002\n\u53d6\u6d88\u7387 \u7684\u8ba1\u7b97\u65b9\u5f0f\u5982\u4e0b\uff1a(\u88ab\u53f8\u673a\u6216\u4e58\u5ba2\u53d6\u6d88\u7684\u975e\u7981\u6b62\u7528\u6237\u751f\u6210\u7684\u8ba2\u5355\u6570\u91cf) / (\u975e\u7981\u6b62\u7528\u6237\u751f\u6210\u7684\u8ba2\u5355\u603b\u6570)\u3002"}),"\n",(0,t.jsx)(d.h3,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,t.jsx)(d.h4,{id:"\u8f93\u5165",children:"\u8f93\u5165"}),"\n",(0,t.jsxs)(d.p,{children:[(0,t.jsx)(d.strong,{children:"Trips"})," \u8868\uff1a"]}),"\n",(0,t.jsxs)(d.table,{children:[(0,t.jsx)(d.thead,{children:(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.th,{children:"id"}),(0,t.jsx)(d.th,{children:"client_id"}),(0,t.jsx)(d.th,{children:"driver_id"}),(0,t.jsx)(d.th,{children:"city_id"}),(0,t.jsx)(d.th,{children:"status"}),(0,t.jsx)(d.th,{children:"request_at"})]})}),(0,t.jsxs)(d.tbody,{children:[(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"1"}),(0,t.jsx)(d.td,{children:"1"}),(0,t.jsx)(d.td,{children:"10"}),(0,t.jsx)(d.td,{children:"1"}),(0,t.jsx)(d.td,{children:"completed"}),(0,t.jsx)(d.td,{children:"2013-10-01"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"2"}),(0,t.jsx)(d.td,{children:"2"}),(0,t.jsx)(d.td,{children:"11"}),(0,t.jsx)(d.td,{children:"1"}),(0,t.jsx)(d.td,{children:"cancelled_by_driver"}),(0,t.jsx)(d.td,{children:"2013-10-01"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"3"}),(0,t.jsx)(d.td,{children:"3"}),(0,t.jsx)(d.td,{children:"12"}),(0,t.jsx)(d.td,{children:"6"}),(0,t.jsx)(d.td,{children:"completed"}),(0,t.jsx)(d.td,{children:"2013-10-01"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"4"}),(0,t.jsx)(d.td,{children:"4"}),(0,t.jsx)(d.td,{children:"13"}),(0,t.jsx)(d.td,{children:"6"}),(0,t.jsx)(d.td,{children:"cancelled_by_client"}),(0,t.jsx)(d.td,{children:"2013-10-01"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"5"}),(0,t.jsx)(d.td,{children:"1"}),(0,t.jsx)(d.td,{children:"10"}),(0,t.jsx)(d.td,{children:"1"}),(0,t.jsx)(d.td,{children:"completed"}),(0,t.jsx)(d.td,{children:"2013-10-02"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"6"}),(0,t.jsx)(d.td,{children:"2"}),(0,t.jsx)(d.td,{children:"11"}),(0,t.jsx)(d.td,{children:"6"}),(0,t.jsx)(d.td,{children:"completed"}),(0,t.jsx)(d.td,{children:"2013-10-02"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"7"}),(0,t.jsx)(d.td,{children:"3"}),(0,t.jsx)(d.td,{children:"12"}),(0,t.jsx)(d.td,{children:"6"}),(0,t.jsx)(d.td,{children:"completed"}),(0,t.jsx)(d.td,{children:"2013-10-02"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"8"}),(0,t.jsx)(d.td,{children:"2"}),(0,t.jsx)(d.td,{children:"12"}),(0,t.jsx)(d.td,{children:"12"}),(0,t.jsx)(d.td,{children:"completed"}),(0,t.jsx)(d.td,{children:"2013-10-03"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"9"}),(0,t.jsx)(d.td,{children:"3"}),(0,t.jsx)(d.td,{children:"10"}),(0,t.jsx)(d.td,{children:"12"}),(0,t.jsx)(d.td,{children:"completed"}),(0,t.jsx)(d.td,{children:"2013-10-03"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"10"}),(0,t.jsx)(d.td,{children:"4"}),(0,t.jsx)(d.td,{children:"13"}),(0,t.jsx)(d.td,{children:"12"}),(0,t.jsx)(d.td,{children:"cancelled_by_driver"}),(0,t.jsx)(d.td,{children:"2013-10-03"})]})]})]}),"\n",(0,t.jsxs)(d.p,{children:[(0,t.jsx)(d.strong,{children:"Users"})," \u8868\uff1a"]}),"\n",(0,t.jsxs)(d.table,{children:[(0,t.jsx)(d.thead,{children:(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.th,{children:"users_id"}),(0,t.jsx)(d.th,{children:"banned"}),(0,t.jsx)(d.th,{children:"role"})]})}),(0,t.jsxs)(d.tbody,{children:[(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"1"}),(0,t.jsx)(d.td,{children:"No"}),(0,t.jsx)(d.td,{children:"client"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"2"}),(0,t.jsx)(d.td,{children:"Yes"}),(0,t.jsx)(d.td,{children:"client"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"3"}),(0,t.jsx)(d.td,{children:"No"}),(0,t.jsx)(d.td,{children:"client"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"4"}),(0,t.jsx)(d.td,{children:"No"}),(0,t.jsx)(d.td,{children:"client"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"10"}),(0,t.jsx)(d.td,{children:"No"}),(0,t.jsx)(d.td,{children:"driver"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"11"}),(0,t.jsx)(d.td,{children:"No"}),(0,t.jsx)(d.td,{children:"driver"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"12"}),(0,t.jsx)(d.td,{children:"No"}),(0,t.jsx)(d.td,{children:"driver"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"13"}),(0,t.jsx)(d.td,{children:"No"}),(0,t.jsx)(d.td,{children:"driver"})]})]})]}),"\n",(0,t.jsx)(d.h4,{id:"\u8f93\u51fa",children:"\u8f93\u51fa"}),"\n",(0,t.jsxs)(d.table,{children:[(0,t.jsx)(d.thead,{children:(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.th,{children:"Day"}),(0,t.jsx)(d.th,{children:"Cancellation Rate"})]})}),(0,t.jsxs)(d.tbody,{children:[(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"2013-10-01"}),(0,t.jsx)(d.td,{children:"0.33"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"2013-10-02"}),(0,t.jsx)(d.td,{children:"0.00"})]}),(0,t.jsxs)(d.tr,{children:[(0,t.jsx)(d.td,{children:"2013-10-03"}),(0,t.jsx)(d.td,{children:"0.50"})]})]})]}),"\n",(0,t.jsx)(d.h4,{id:"\u89e3\u91ca",children:"\u89e3\u91ca"}),"\n",(0,t.jsx)(d.p,{children:"2013-10-01\uff1a"}),"\n",(0,t.jsxs)(d.ul,{children:["\n",(0,t.jsx)(d.li,{children:"\u5171\u6709 4 \u6761\u8bf7\u6c42\uff0c\u5176\u4e2d 2 \u6761\u53d6\u6d88\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u7136\u800c\uff0cid=2 \u7684\u8bf7\u6c42\u662f\u7531\u7981\u6b62\u7528\u6237\uff08user_id=2\uff09\u53d1\u51fa\u7684\uff0c\u6240\u4ee5\u8ba1\u7b97\u65f6\u5e94\u5f53\u5ffd\u7565\u5b83\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u56e0\u6b64\uff0c\u603b\u5171\u6709 3 \u6761\u975e\u7981\u6b62\u8bf7\u6c42\u53c2\u4e0e\u8ba1\u7b97\uff0c\u5176\u4e2d 1 \u6761\u53d6\u6d88\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u53d6\u6d88\u7387\u4e3a (1 / 3) = 0.33\n2013-10-02\uff1a"}),"\n",(0,t.jsx)(d.li,{children:"\u5171\u6709 3 \u6761\u8bf7\u6c42\uff0c\u5176\u4e2d 0 \u6761\u53d6\u6d88\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u7136\u800c\uff0cid=6 \u7684\u8bf7\u6c42\u662f\u7531\u7981\u6b62\u7528\u6237\u53d1\u51fa\u7684\uff0c\u6240\u4ee5\u8ba1\u7b97\u65f6\u5e94\u5f53\u5ffd\u7565\u5b83\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u56e0\u6b64\uff0c\u603b\u5171\u6709 2 \u6761\u975e\u7981\u6b62\u8bf7\u6c42\u53c2\u4e0e\u8ba1\u7b97\uff0c\u5176\u4e2d 0 \u6761\u53d6\u6d88\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u53d6\u6d88\u7387\u4e3a (0 / 2) = 0.00\n2013-10-03\uff1a"}),"\n",(0,t.jsx)(d.li,{children:"\u5171\u6709 3 \u6761\u8bf7\u6c42\uff0c\u5176\u4e2d 1 \u6761\u53d6\u6d88\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u7136\u800c\uff0cid=8 \u7684\u8bf7\u6c42\u662f\u7531\u7981\u6b62\u7528\u6237\u53d1\u51fa\u7684\uff0c\u6240\u4ee5\u8ba1\u7b97\u65f6\u5e94\u5f53\u5ffd\u7565\u5b83\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u56e0\u6b64\uff0c\u603b\u5171\u6709 2 \u6761\u975e\u7981\u6b62\u8bf7\u6c42\u53c2\u4e0e\u8ba1\u7b97\uff0c\u5176\u4e2d 1 \u6761\u53d6\u6d88\u3002"}),"\n",(0,t.jsx)(d.li,{children:"\u53d6\u6d88\u7387\u4e3a (1 / 2) = 0.50"}),"\n"]}),"\n",(0,t.jsx)(d.h2,{id:"\u53c2\u8003\u7b54\u6848",children:"\u53c2\u8003\u7b54\u6848"}),"\n",(0,t.jsx)(d.pre,{children:(0,t.jsx)(d.code,{className:"language-SQL",children:"with t1 as(\n    select\n         (case when Status = 'completed' then 0 else 1 end) as status\n        ,Request_at\n     from Trips\n    where Client_Id not in (select Users_Id from Users where Banned = 'Yes')\n      and Driver_Id not in (select Users_Id from Users where Banned = 'Yes')\n      and Request_at between '2013-10-01' and '2013-10-03'\n)\nselect\n     Request_at as `Day`\n    ,round(sum(status)/count(status),2) as `Cancellation Rate`\nfrom t1 \ngroup by Request_at\n;\n"})})]})}function j(e={}){const{wrapper:d}={...(0,r.R)(),...e.components};return d?(0,t.jsx)(d,{...e,children:(0,t.jsx)(x,{...e})}):x(e)}}}]);