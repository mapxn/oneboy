"use strict";(self.webpackChunkoneboy_app=self.webpackChunkoneboy_app||[]).push([[4969],{1911:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var t=s(9729);const r={},a=t.createContext(r);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:n},e.children)}},9462:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"container/hysteria","title":"Hysteria","description":"\u5b98\u65b9\u7f51\u7ad9","source":"@site/docs/container/hysteria.md","sourceDirName":"container","slug":"/container/hysteria","permalink":"/docs/container/hysteria","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1745228903000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"leetcodeSidebar","previous":{"title":"Frps","permalink":"/docs/container/frps"},"next":{"title":"X-UI","permalink":"/docs/container/x-ui"}}');var r=s(5813),a=s(1911);const i={sidebar_position:2},o="Hysteria",c={},l=[{value:"\u5b98\u65b9\u7f51\u7ad9",id:"\u5b98\u65b9\u7f51\u7ad9",level:2},{value:"Docker\u65b9\u5f0f\u5b89\u88c5",id:"docker\u65b9\u5f0f\u5b89\u88c5",level:2},{value:"compose\u6587\u4ef6",id:"compose\u6587\u4ef6",level:3},{value:"env\u6587\u4ef6",id:"env\u6587\u4ef6",level:3},{value:"\u542f\u52a8",id:"\u542f\u52a8",level:3},{value:"\u914d\u7f6e\u6587\u4ef6",id:"\u914d\u7f6e\u6587\u4ef6",level:3},{value:"\u91cd\u65b0\u542f\u52a8",id:"\u91cd\u65b0\u542f\u52a8",level:3},{value:"\u5907\u6ce8",id:"\u5907\u6ce8",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"hysteria",children:"Hysteria"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5b98\u65b9\u7f51\u7ad9",children:"\u5b98\u65b9\u7f51\u7ad9"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://v2.hysteria.network/",children:"https://v2.hysteria.network/"})}),"\n",(0,r.jsx)(n.h2,{id:"docker\u65b9\u5f0f\u5b89\u88c5",children:"Docker\u65b9\u5f0f\u5b89\u88c5"}),"\n",(0,r.jsx)(n.h3,{id:"compose\u6587\u4ef6",children:"compose\u6587\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:'services:\n  hysteria:\n    image: tobyxdd/hysteria\n    container_name: hysteria\n    restart: unless-stopped\n    network_mode: host\n    volumes:\n      - ${DOCKER_HOME}/hysteria/conf:/hysteria/conf\n      - ${DOCKER_HOME}/npm/letsencrypt/archive:/hysteria/letsencrypt/archive:ro\n      - ${DOCKER_HOME}/npm/letsencrypt/live:/hysteria/letsencrypt/live:ro\n      - /etc/localtime:/etc/localtime:ro\n      - /etc/timezone:/etc/timezone:ro\n    command: ["server", "-c", "/hysteria/conf/hysteria.yml"]\n    environment:\n      - HYSTERIA_DISABLE_UPDATE_CHECK=1\n    cap_add:\n      - NET_ADMIN\n      - NET_BIND_SERVICE\n      - SYS_PTRACE\n      - DAC_READ_SEARCH\n    devices:\n      - \'/dev/net/tun:/dev/net/tun\'\n    deploy:\n      resources:\n        limits:\n          cpus: \'0.5\'\n          memory: 256M\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5982\u4e0b\u6240\u793a\uff0c\u8fd9\u91cc\u6302\u8f7d\u4e86 NPM \u7684\u4e24\u4e2a\u76ee\u5f55\uff0c\u662f\u4e3a\u4e86\u53ef\u4ee5\u53d6\u5230\u5bf9\u5e94\u57df\u540d\u7684\u8bc1\u4e66\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:"      - ${DOCKER_HOME}/npm/letsencrypt/archive:/hysteria/letsencrypt/archive:ro\n      - ${DOCKER_HOME}/npm/letsencrypt/live:/hysteria/letsencrypt/live:ro\n"})}),"\n",(0,r.jsx)(n.h3,{id:"env\u6587\u4ef6",children:"env\u6587\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"DOCKER_HOME=/home/username/docker\nDOCKER_MY_NETWORK=npm_default\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u542f\u52a8",children:"\u542f\u52a8"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker compose up -d\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u914d\u7f6e\u6587\u4ef6",children:"\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yml",children:"listen: :443 #\u9ed8\u8ba4\u7aef\u53e3443\uff0c\u53ef\u4ee5\u4fee\u6539\u4e3a\u5176\u4ed6\u7aef\u53e3\n# \u4ee5\u4e0b acme \u548c tls \u5b57\u6bb5\uff0c\u4e8c\u9009\u4e00\n# \u6709\u57df\u540d\u90e8\u7f72\u7684\u9009\u62e9 acme \uff0c\u65e0\u57df\u540d\u7684\u9009\u62e9 tls\n# \u9009\u62e9 acme\uff0c\u5fc5\u987b\u6ce8\u91ca\u6389 tls\uff0c\u53cd\u4e4b\u4e00\u6837\n#\u4f7f\u7528CA\u8bc1\u4e66\n#acme:\n#  domains:\n#    - your.domain.net #\u5df2\u7ecf\u89e3\u6790\u5230\u670d\u52a1\u5668\u7684\u57df\u540d\n#  email: your@email.com #\u4f60\u7684\u90ae\u7bb1\n\nbandwidth:\n  up: 300 mbps\n  down: 300 mbps\nignoreClientBandwidth: true\n\nspeedTest: false\ndisableUDP: false\nudpIdleTimeout: 120s\n\n#\u4f7f\u7528\u81ea\u7b7e\u8bc1\u4e66 \u3010\u5c0f\u767d\u63a8\u8350\u8fd9\u4e2a\u3011\uff0c\u627e\u5230\u4f60\u5bf9\u5e94\u57df\u540d\u7684\u8bc1\u4e66\u8def\u5f84\uff0c\u7531NPM\u7ba1\u7406\uff0c\u81ea\u52a8\u7533\u8bf7/\u7eed\u671f\u3002\ntls:\n  cert: /hysteria/letsencrypt/live/npm-123/cert.pem\n  key: /hysteria/letsencrypt/live/npm-123/privkey.pem\n  # strict | disable | dns-san \n  sniGuard: strict\n\n# \u8fd9\u91cc\u7684\u8ba4\u8bc1\u65b9\u5f0f\u662fuserpass\uff0c\u6240\u4ee5password\u8fd9\u4e00\u884c\u662f\u591a\u4f59\u7684\u3002\u8bf7\u4f7f\u7528\u4e00\u4e2a\u5f3a\u5bc6\u7801\u8fdb\u884c\u66ff\u6362\nauth:\n  type: userpass\n  password: CjZ8o96eBxj4HXK5zVTt\n  userpass: \n    user1: sdwaqnEKUai85sBKFEj5\n    user2: YFoo8CxnHbuCSHXbHfEL\n# auth:\n#     type: http\n#     http:\n#         url: http://127.0.0.1:8081/hui/hysteria2/auth\n#         insecure: true\n\nresolver:\n  type: udp\n  tcp:\n    addr: 8.8.8.8:53 \n    timeout: 4s \n  udp:\n    addr: 8.8.4.4:53 \n    timeout: 4s\n  tls:\n    addr: 1.1.1.1:853 \n    timeout: 10s\n    sni: cloudflare-dns.com \n    insecure: false \n  https:\n    addr: 1.1.1.1:443 \n    timeout: 10s\n    sni: cloudflare-dns.com\n    insecure: false\n\n# \u57df\u540d\u55c5\u63a2\uff0c\u914d\u5408\u5206\u6d41\u6216\u8005acl\uff08\u51fa\u7ad9\u7684\u8bbf\u95ee\u63a7\u5236\u89c4\u5219\uff09\u4f7f\u7528\uff0c\u9ed8\u8ba4\u4e3a\u5f00\u542f\nsniff:\n  enable: true \n  timeout: 2s \n  rewriteDomain: false \n  tcpPorts: 80,443,8000-9000\n  udpPorts: all\n\n# \u51fa\u7ad9\u8bbe\u7f6e\uff0c\u82e5\u65e0\u7279\u6b8a\u9700\u8981\uff0c\u5219\u65e0\u9700\u989d\u5916\u4fee\u6539\u6b64\u5904\u7684\u5b57\u6bb5\noutbounds:\n  - name: freedom \n    type: direct\n    direct:\n      mode: auto \n# obfs:\n#   type: salamander \n#   salamander:\n#     password: YFoo8CxnHbuCSHXbHfEL\n\n# \u4f2a\u88c5\u5b57\u6bb5\uff0c\u82e5\u4e0d\u9700\u8981\u53ef\u5220\u9664\uff0c\u82e5\u9700\u8981\u53ef\u53c2\u7167\u5b98\u65b9\u6587\u6863\u6309\u9700\u4fee\u6539\n# \u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u62a5\u6587\u56de\u590d\u53ef\u9690\u85cf\u5bf9\u5e94\u7aef\u53e3\u5f00\u653e\u7684\u670d\u52a1\u662f\u4e00\u4e2ahysteria\u670d\u52a1\u7aef\u7a0b\u5e8f\u7684\u4e8b\u5b9e\n# masquerade: \n#   type: string\n#   string:\n#     content: Invalid request, please use correct method.\n#     headers: \n#       Server: quic-server\n#       Content-Type: application/octet-stream; charset=UTF-8\n#       Cache-Control: no-store\n#       Content-Length: 8\n#       Content-Encoding: compress\n#       Connection: close\n#     statusCode: 200\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u91cd\u65b0\u542f\u52a8",children:"\u91cd\u65b0\u542f\u52a8"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker restart hysteria\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5907\u6ce8",children:"\u5907\u6ce8"}),"\n",(0,r.jsx)(n.p,{children:"\u4f1a\u8d70443\u7aef\u53e3\u7684udp\u6d41\u91cf\uff0c\u9700\u8981UFW\u9632\u706b\u5899\u653e\u884c443\u7aef\u53e3UDP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"sudo ufw allow 443/udp\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53e6NPM\u9700\u8981\u5f00\u542fHTTP2\u3002"})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);